<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L1 Technischer Support - Schichtplaner 2025</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1><i class="fas fa-calendar-alt"></i> L1 Technischer Support - Schichtplaner 2025</h1>
                <div class="header-controls">
                    <button id="prevWeek" class="btn-nav"><i class="fas fa-chevron-left"></i> Vorherige Woche</button>
                    <button id="todayBtn" class="btn-today"><i class="fas fa-calendar-day"></i> Heute</button>
                    <button id="nextWeek" class="btn-nav">NÃ¤chste Woche <i class="fas fa-chevron-right"></i></button>
                    <div class="export-dropdown">
                        <button id="exportBtn" class="btn-export"><i class="fas fa-download"></i> Export <i class="fas fa-chevron-down"></i></button>
                        <div id="exportMenu" class="export-menu">
                            <button onclick="exportCurrentWeekOptimized()" style="background: linear-gradient(135deg, #00ffff 0%, #00cccc 100%); font-weight: bold;"><i class="fas fa-star"></i> Diese Woche (Outlook optimiert) ðŸ”¥</button>
                            <button onclick="exportCurrentWeek()"><i class="fas fa-calendar-week"></i> Diese Woche (Standard)</button>
                            <button onclick="exportCurrentWeekSeparate()"><i class="fas fa-file-medical"></i> Diese Woche (einzeln)</button>
                            <button onclick="exportEmployeeMenu()"><i class="fas fa-user"></i> Nach Mitarbeiter</button>
                            <button onclick="exportAll()"><i class="fas fa-calendar"></i> Alle Schichten</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="week-info">
                <span id="weekDisplay">Woche 50, 2025</span>
                <span id="dateRange">20. - 26. Oktober 2025</span>
            </div>
        </header>

        <div class="calendar-wrapper">
            <div class="calendar-grid">
                <!-- Mitarbeiter-Spalte -->
                <div class="employee-column">
                    <div class="employee-header">Mitarbeiter</div>
                    <div class="employee-cell">
                        <div class="employee-info">
                            <i class="fas fa-user-circle"></i>
                            <div>
                                <strong>Tamara Sand</strong>
                                <small>NRW</small>
                            </div>
                        </div>
                    </div>
                    <div class="employee-cell">
                        <div class="employee-info">
                            <i class="fas fa-user-circle"></i>
                            <div>
                                <strong>Diana</strong>
                                <small>BW</small>
                            </div>
                        </div>
                    </div>
                    <div class="employee-cell">
                        <div class="employee-info">
                            <i class="fas fa-user-circle"></i>
                            <div>
                                <strong>Diko</strong>
                                <small>HB</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Kalender-Tage -->
                <div id="calendarDays" class="calendar-days">
                    <!-- Wird dynamisch mit JavaScript gefÃ¼llt -->
                </div>
            </div>
        </div>

        <div class="legend">
            <h3>Legende</h3>
            <div class="legend-items">
                <div class="legend-item"><span class="legend-color shift"></span> Schicht</div>
                <div class="legend-item"><span class="legend-color vacation"></span> Urlaub</div>
                <div class="legend-item"><span class="legend-color sick"></span> Krankheit</div>
                <div class="legend-item"><span class="legend-color overtime"></span> Ãœberstunden</div>
                <div class="legend-item"><span class="legend-color holiday"></span> Feiertag</div>
            </div>
        </div>

        <div class="export-info">
            <h3><i class="fas fa-info-circle"></i> Outlook Kalender Integration</h3>
            <p>Nutze den <strong>Export-Button</strong> oben, um Schichten als .ics-Datei zu exportieren und in Outlook, Google Calendar oder andere Kalender-Apps zu importieren.</p>
        </div>
    </div>

    <!-- Modal fÃ¼r Eintrag hinzufÃ¼gen/bearbeiten -->
    <div id="entryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Eintrag hinzufÃ¼gen</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <form id="entryForm">
                <input type="hidden" id="entryId">
                <input type="hidden" id="entryEmployee">
                <input type="hidden" id="entryDate">
                
                <div class="form-group">
                    <label>Mitarbeiter:</label>
                    <div class="readonly-field" id="displayEmployee"></div>
                </div>

                <div class="form-group">
                    <label>Datum:</label>
                    <div class="readonly-field" id="displayDate"></div>
                </div>

                <div class="form-group">
                    <label for="entryType">Typ:</label>
                    <select id="entryType" required>
                        <option value="shift">Schicht</option>
                        <option value="vacation">Urlaub</option>
                        <option value="sick">Krankheit</option>
                        <option value="overtime">Ãœberstunden</option>
                    </select>
                </div>

                <!-- Datumsbereich fÃ¼r mehrtÃ¤gige EintrÃ¤ge -->
                <div id="dateRangeFields" style="display: none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="startDate">Von Datum:</label>
                            <input type="date" id="startDate">
                        </div>
                        <div class="form-group">
                            <label for="endDate">Bis Datum:</label>
                            <input type="date" id="endDate">
                        </div>
                    </div>
                    <div class="info-message">
                        <i class="fas fa-info-circle"></i> <strong>Mehrere Tage:</strong> Es wird fÃ¼r jeden Tag im Zeitraum ein separater Eintrag erstellt.
                    </div>
                </div>

                <div id="timeFields">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="startTime">Startzeit:</label>
                            <input type="time" id="startTime">
                        </div>
                        <div class="form-group">
                            <label for="endTime">Endzeit:</label>
                            <input type="time" id="endTime">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="notes">Notizen (optional):</label>
                    <textarea id="notes" rows="3"></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal()">Abbrechen</button>
                    <button type="submit" class="btn-primary">Speichern</button>
                </div>
                <div class="modal-export" id="modalExport" style="display: none;">
                    <button type="button" class="btn-export-single" onclick="exportCurrentEntry()"><i class="fas fa-download"></i> In Outlook exportieren</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/holidays.js"></script>
    <script src="js/calendar-export.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
